
## 1. **SHA-1**

* **Where used:**

  * Legacy **Load File Data Block Hash (LFDBH)** when combined with 3DES.
  * Default digest in **SCP10 Secure Channel Protocol** for entity authentication.
  * In RSA signatures (RSASSA-PKCS1-v1\_5 with 1024-bit keys).
* **Why used:** Historically the standard for integrity checks and signatures. Still supported for backward compatibility with older systems/cards.
* **When used:** Only allowed when using 3DES or RSA-1024; discouraged in modern deployments due to known weaknesses.

---

## 2. **SHA-256**

* **Where used:**

  * LFDBH when AES-128 encryption is in play.
  * RSA signatures with RSASSA-PSS and OAEP (for >1024-bit keys).
  * Required for **ECDSA with 256-bit ECC keys**.
* **Why used:** Provides stronger security (256-bit digest) against collision attacks, aligned with NIST modern crypto recommendations.
* **When used:** Default in most new deployments; replaces SHA-1 in tokens, receipts, and signatures.

---

## 3. **SHA-384**

* **Where used:**

  * LFDBH when AES-192 encryption is used.
  * Required for **ECDSA with 384-bit ECC keys**.
* **Why used:** Higher security strength to match larger ECC key sizes or AES-192 encryption.
* **When used:** Security domains/cards needing stronger than SHA-256 but not full 512-bit.

---

## 4. **SHA-512**

* **Where used:**

  * LFDBH when AES-256 encryption is used.
  * Required for **ECDSA with 512/521-bit ECC keys**.
* **Why used:** Provides the highest integrity strength, ensuring resistance against future collision or preimage attacks.
* **When used:** For maximum security environments (AES-256, ECC-512+), especially in high-assurance or government-grade applications.

---

## 5. **MULTOS Asymmetric Hash Algorithm**

* **Where used:** Only in GlobalPlatform on **MULTOS cards**.
* **Why used:** A platform-specific hashing mechanism for asymmetric operations on MULTOS.
* **When used:** If the card implementation is based on MULTOS OS rather than Java Card.

---

## 6. **Hashing in DAP (Data Authentication Pattern) & Tokens**

* **LFDBH as input to signatures:**

  * Tokens (Load, Install, etc.) and Receipts are generated by signing a hash of critical fields including LFDBH.
  * DAP blocks are signatures over LFDBH, proving integrity and approval of applets loaded onto the card.
* **Why used:** The hash condenses potentially large code/data into a fixed digest, making signing efficient while still guaranteeing integrity.
* **When used:** Every time card content is **loaded, verified, or authorized**.

---

## 7. **Hashing with RSA Signatures**

* **RSASSA-PKCS1-v1\_5 (RSA-1024):** always uses **SHA-1**.
* **RSASSA-PSS / RSA-OAEP (>1024-bit):** always uses **SHA-256**.
* **Why used:** To provide digital signatures for Tokens, Receipts, or DAP blocks where RSA is selected.
* **When used:** Depending on RSA key size and migration strategy.

---

## 8. **Hashing with ECDSA**

* **ECC-256:** SHA-256
* **ECC-384:** SHA-384
* **ECC-512/521:** SHA-512
* **Why used:** NIST FIPS 186-4 mandates that hash strength must match or exceed ECC key strength.
* **When used:** For ECDSA signatures across tokens, receipts, and card authentication.

---

✅ **In summary:**

* **SHA-1** → legacy, only with 3DES & RSA-1024.
* **SHA-256** → modern default, AES-128, ECC-256, RSA-PSS/OAEP.
* **SHA-384** → for AES-192, ECC-384.
* **SHA-512** → for AES-256, ECC-512+.
* **MULTOS Hash** → only on MULTOS cards.
* Hashes are used to generate **LFDBH**, and then signed in **DAP verification, Tokens, and Receipts** to ensure both integrity and origin authentication.

---

