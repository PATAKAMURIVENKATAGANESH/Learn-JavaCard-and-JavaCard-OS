
## 1. **SHA-1**

* **Where used:**

  * Legacy **Load File Data Block Hash (LFDBH)** when combined with 3DES.
  * Default digest in **SCP10 Secure Channel Protocol** for entity authentication.
  * In RSA signatures (RSASSA-PKCS1-v1\_5 with 1024-bit keys).
* **Why used:** Historically the standard for integrity checks and signatures. Still supported for backward compatibility with older systems/cards.
* **When used:** Only allowed when using 3DES or RSA-1024; discouraged in modern deployments due to known weaknesses.

---

## 2. **SHA-256**

* **Where used:**

  * LFDBH when AES-128 encryption is in play.
  * RSA signatures with RSASSA-PSS and OAEP (for >1024-bit keys).
  * Required for **ECDSA with 256-bit ECC keys**.
* **Why used:** Provides stronger security (256-bit digest) against collision attacks, aligned with NIST modern crypto recommendations.
* **When used:** Default in most new deployments; replaces SHA-1 in tokens, receipts, and signatures.

---

## 3. **SHA-384**

* **Where used:**

  * LFDBH when AES-192 encryption is used.
  * Required for **ECDSA with 384-bit ECC keys**.
* **Why used:** Higher security strength to match larger ECC key sizes or AES-192 encryption.
* **When used:** Security domains/cards needing stronger than SHA-256 but not full 512-bit.

---

## 4. **SHA-512**

* **Where used:**

  * LFDBH when AES-256 encryption is used.
  * Required for **ECDSA with 512/521-bit ECC keys**.
* **Why used:** Provides the highest integrity strength, ensuring resistance against future collision or preimage attacks.
* **When used:** For maximum security environments (AES-256, ECC-512+), especially in high-assurance or government-grade applications.

---

## 5. **MULTOS Asymmetric Hash Algorithm**

* **Where used:** Only in GlobalPlatform on **MULTOS cards**.
* **Why used:** A platform-specific hashing mechanism for asymmetric operations on MULTOS.
* **When used:** If the card implementation is based on MULTOS OS rather than Java Card.

---

## 6. **Hashing in DAP (Data Authentication Pattern) & Tokens**

* **LFDBH as input to signatures:**

  * Tokens (Load, Install, etc.) and Receipts are generated by signing a hash of critical fields including LFDBH.
  * DAP blocks are signatures over LFDBH, proving integrity and approval of applets loaded onto the card.
* **Why used:** The hash condenses potentially large code/data into a fixed digest, making signing efficient while still guaranteeing integrity.
* **When used:** Every time card content is **loaded, verified, or authorized**.

---

## 7. **Hashing with RSA Signatures**

* **RSASSA-PKCS1-v1\_5 (RSA-1024):** always uses **SHA-1**.
* **RSASSA-PSS / RSA-OAEP (>1024-bit):** always uses **SHA-256**.
* **Why used:** To provide digital signatures for Tokens, Receipts, or DAP blocks where RSA is selected.
* **When used:** Depending on RSA key size and migration strategy.

---

## 8. **Hashing with ECDSA**

* **ECC-256:** SHA-256
* **ECC-384:** SHA-384
* **ECC-512/521:** SHA-512
* **Why used:** NIST FIPS 186-4 mandates that hash strength must match or exceed ECC key strength.
* **When used:** For ECDSA signatures across tokens, receipts, and card authentication.

---

‚úÖ **In summary:**

* **SHA-1** ‚Üí legacy, only with 3DES & RSA-1024.
* **SHA-256** ‚Üí modern default, AES-128, ECC-256, RSA-PSS/OAEP.
* **SHA-384** ‚Üí for AES-192, ECC-384.
* **SHA-512** ‚Üí for AES-256, ECC-512+.
* **MULTOS Hash** ‚Üí only on MULTOS cards.
* Hashes are used to generate **LFDBH**, and then signed in **DAP verification, Tokens, and Receipts** to ensure both integrity and origin authentication.

---
**table mapping** each hashing technique in the **GlobalPlatform Card Specification v2.3.1** to the contexts where it‚Äôs used (Tokens, Receipts, LFDBH, Secure Channel Protocols, etc.)

---

### üîê Cryptographic Hashing Techniques in GP Spec v2.3.1

| **Hash Algorithm**         | **Where Used**                                                                                                                    | **Why Used**                                                                                   | **When Applied**                                                      |
| -------------------------- | --------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------- | --------------------------------------------------------------------- |
| **SHA-1**                  | - LFDBH with **3DES** encryption<br>- RSA (PKCS1 v1.5, 1024-bit)<br>- SCP10 Secure Channel (default digest)                       | Backward compatibility with older GP systems; small digest size, efficient on low-power cards. | Legacy cards, RSA-1024 signatures, 3DES-protected content.            |
| **SHA-256**                | - LFDBH with **AES-128**<br>- RSA PSS/OAEP (>1024-bit)<br>- ECDSA with 256-bit ECC<br>- Tokens & Receipts (default modern choice) | Stronger collision resistance; matches AES-128 and ECC-256 strength.                           | Default in modern GP deployments; tokens, receipts, signatures.       |
| **SHA-384**                | - LFDBH with **AES-192**<br>- ECDSA with 384-bit ECC                                                                              | Provides security strength matching AES-192 and ECC-384.                                       | Used in higher-security deployments where AES-192/ECC-384 are chosen. |
| **SHA-512**                | - LFDBH with **AES-256**<br>- ECDSA with ECC-512/521                                                                              | Provides maximum collision and preimage resistance; aligns with AES-256/ECC-521.               | High-assurance environments (govt/defense), AES-256 secured content.  |
| **MULTOS Asymmetric Hash** | - MULTOS-specific asymmetric operations                                                                                           | Optimized for MULTOS platform crypto stack.                                                    | Only on cards running MULTOS OS.                                      |

---

### üì¶ Hash Usage in Key GP Mechanisms

| **Mechanism**                                                              | **Hash Role**                                            | **Hash Selection Rule**                                                                 |
| -------------------------------------------------------------------------- | -------------------------------------------------------- | --------------------------------------------------------------------------------------- |
| **LFDBH (Load File Data Block Hash)**                                      | Computes integrity digest of applet code before loading. | - SHA-1 if 3DES<br>- SHA-256 if AES-128<br>- SHA-384 if AES-192<br>- SHA-512 if AES-256 |
| **DAP Verification**                                                       | Signs the LFDBH with issuer‚Äôs key to prove authenticity. | Uses same hash as LFDBH for consistency.                                                |
| **Tokens (Load, Install, Make Selectable, Delete, Registry Update, etc.)** | Token = signature over hash of parameters + LFDBH.       | Follows LFDBH rule; default SHA-256 in modern systems.                                  |
| **Receipts (Load, Install, Delete, etc.)**                                 | Receipt = signature over hash of operation results.      | Same rule as Tokens; ensures traceable audit integrity.                                 |
| **RSA Signatures**                                                         | Hash used in PKCS#1 v1.5 or PSS signing.                 | - SHA-1 for 1024-bit RSA<br>- SHA-256 for >1024-bit RSA                                 |
| **ECDSA Signatures**                                                       | Hash required before signing with ECC private key.       | - SHA-256 for ECC-256<br>- SHA-384 for ECC-384<br>- SHA-512 for ECC-512/521             |
| **Secure Channel Protocols (SCP)**                                         | Used for entity authentication, C-MAC, R-MAC.            | SCP10: SHA-1 (legacy)<br>SCP11: SHA-256 / SHA-384 / SHA-512 depending on suite          |

---

‚úÖ **In short:**

* Hashing is the foundation for **integrity (LFDBH, receipts)** and **authenticity (tokens, DAP, SCP authentication)**.
* The spec enforces **hash-to-key-strength matching**: SHA-1 for 3DES/RSA-1024, SHA-256 for AES-128/ECC-256, SHA-384 for AES-192/ECC-384, SHA-512 for AES-256/ECC-512+.
* Tokens and receipts always rely on the **same hash as LFDBH**, keeping the chain of trust consistent.

---




